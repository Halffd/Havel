// Test monad support for pipeline chains

// Test Maybe monad
let maybeValue = maybe(42)
let maybeEmpty = maybe()

// Test Optional monad  
let optionalValue = optional("hello")
let optionalEmpty = optional()

// Test Result monad
let successResult = result(100)
let errorResult = result(0, "Division error")

// Test Promise monad
let resolvedPromise = promise("done")
let unresolvedPromise = promise()

// Test Error monad
let errorMessage = error("Something went wrong")
let errorWithValue = error("Invalid input", 42)

// Test monads in pipeline chains
let data = [1, 2, 3, null, "test"]

// Pipeline with Maybe monad - should stop on first null/empty
let maybeResult = data 
  | maybe(x => x * 2) 
  | maybe(x => x + 10)

// Pipeline with Optional monad - should continue on empty values
let optionalResult = data
  | optional(x => x * 3)  
  | optional(x => x + 5)

// Pipeline with Result monad - should stop on error
let resultPipeline = data
  | result(x => x * 2) 
  | result(x => if x > 0 then x * 3 else error("Negative number"))

// Pipeline with Promise monad
let promisePipeline = data
  | promise(x => x.toString()) 
  | promise(x => "processed: " + x)

// Pipeline with Error monad - should stop on error
let errorPipeline = data
  | error(x => if x != null then x.toString() else error("Null value"))

// Test combining monads
let combined = data
  | maybe(x => x) 
  | optional(y => y + " from optional") 
  | result(z => "final: " + z)

print("Maybe tests:")
print("maybeValue:", maybeValue)
print("maybeEmpty:", maybeEmpty)

print("Optional tests:")
print("optionalValue:", optionalValue)  
print("optionalEmpty:", optionalEmpty)

print("Result tests:")
print("successResult:", successResult)
print("errorResult:", errorResult)

print("Promise tests:")
print("resolvedPromise:", resolvedPromise)
print("unresolvedPromise:", unresolvedPromise)

print("Error tests:")
print("errorMessage:", errorMessage)
print("errorWithValue:", errorWithValue)

print("Pipeline tests:")
print("maybeResult:", maybeResult)
print("optionalResult:", optionalResult)
print("resultPipeline:", resultPipeline)
print("promisePipeline:", promisePipeline)
print("errorPipeline:", errorPipeline)
print("combined:", combined)
